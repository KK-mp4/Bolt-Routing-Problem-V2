import{h as Ht,i as Kt,v as Ut,o as at,c as rt,j as jt,f as Ft,r as dt,g as Wt,k as Ot,a as M,b as ct,w as it,u as U,l as gt,m as _t,d as J,t as ut,n as qt,F as Zt}from"./B6KF3lkT.js";
import{_ as Qt}from"./BbR8EWZf.js";
import{u as Jt}from"./FMAD5iQn.js";
import{u as et}from"./c76gRGXA.js";
import{s as W,d as te,c as Mt,T as xt,e as vt,m as Tt,l as It,b as ee,a as ne}from"./B7PevS6S.js";
var Rt=Object.defineProperty;var $t=(t,n,o)=>n in t?Rt(t,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[n]=o;var St=(t,n,o)=>($t(t,typeof n!="symbol"?n+"":n,o),o);function oe(t){let n;for(;n=t.sourceEvent;)t=n;return t}function ot(t,n){if(t=oe(t),n===void 0&&(n=t.currentTarget),n){var o=n.ownerSVGElement||n;if(o.createSVGPoint){var s=o.createSVGPoint();return s.x=t.clientX,s.y=t.clientY,s=s.matrixTransform(n.getScreenCTM().inverse()),[s.x,s.y]}if(n.getBoundingClientRect){var l=n.getBoundingClientRect();return[t.clientX-l.left-n.clientLeft,t.clientY-l.top-n.clientTop]}}return[t.pageX,t.pageY]}const bt={capture:!0,passive:!1};function zt(t){t.preventDefault(),t.stopImmediatePropagation()}function ae(t){var n=t.document.documentElement,o=W(t).on("dragstart.drag",zt,bt);"onselectstart"in n?o.on("selectstart.drag",zt,bt):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function se(t,n){var o=t.document.documentElement,s=W(t).on("dragstart.drag",null);n&&(s.on("click.drag",zt,bt),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in o?s.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}var ie=1e-12;function Pt(t){return((t=Math.exp(t))+1/t)/2}function re(t){return((t=Math.exp(t))-1/t)/2}function le(t){return((t=Math.exp(2*t))-1)/(t+1)}const ce=function t(n,o,s){function l(i,d){var m=i[0],h=i[1],c=i[2],g=d[0],w=d[1],z=d[2],I=g-m,G=w-h,B=I*I+G*G,E,_;if(B<ie)_=Math.log(z/c)/n,E=function(D){return[m+D*I,h+D*G,c*Math.exp(n*D*_)]};else{var $=Math.sqrt(B),j=(z*z-c*c+s*B)/(2*c*o*$),q=(z*z-c*c-s*B)/(2*z*o*$),k=Math.log(Math.sqrt(j*j+1)-j),v=Math.log(Math.sqrt(q*q+1)-q);_=(v-k)/n,E=function(D){var C=D*_,P=Pt(k),N=c/(o*$)*(P*le(n*C+k)-re(k));return[m+N*I,h+N*G,c*P/Pt(n*C+k)]}}return E.duration=_*1e3*n/Math.SQRT2,E}return l.rho=function(i){var d=Math.max(.001,+i),m=d*d,h=m*m;return t(d,m,h)},l}(Math.SQRT2,2,4),mt=t=>()=>t;function ue(t,{sourceEvent:n,target:o,transform:s,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:l}})}function yt(t){t.stopImmediatePropagation()}function ht(t){t.preventDefault(),t.stopImmediatePropagation()}function he(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function fe(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Vt(){return this.__zoom||Mt}function de(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function me(){return navigator.maxTouchPoints||"ontouchstart"in this}function pe(t,n,o){var s=t.invertX(n[0][0])-o[0][0],l=t.invertX(n[1][0])-o[1][0],i=t.invertY(n[0][1])-o[0][1],d=t.invertY(n[1][1])-o[1][1];return t.translate(l>s?(s+l)/2:Math.min(0,s)||Math.max(0,l),d>i?(i+d)/2:Math.min(0,i)||Math.max(0,d))}function ge(){var t=he,n=fe,o=pe,s=de,l=me,i=[0,1/0],d=[[-1/0,-1/0],[1/0,1/0]],m=250,h=ce,c=te("start","zoom","end"),g,w,z,I=500,G=150,B=0,E=10;function _(e){e.property("__zoom",Vt).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",N).filter(l).on("touchstart.zoom",Z).on("touchmove.zoom",Q).on("touchend.zoom touchcancel.zoom",H).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(e,f,a,r){var p=e.selection?e.selection():e;p.property("__zoom",Vt),e!==p?k(e,f,a,r):p.interrupt().each(function(){v(this,arguments).event(r).start().zoom(null,typeof f=="function"?f.apply(this,arguments):f).end()})},_.scaleBy=function(e,f,a,r){_.scaleTo(e,function(){var p=this.__zoom.k,y=typeof f=="function"?f.apply(this,arguments):f;return p*y},a,r)},_.scaleTo=function(e,f,a,r){_.transform(e,function(){var p=n.apply(this,arguments),y=this.__zoom,b=a==null?q(p):typeof a=="function"?a.apply(this,arguments):a,x=y.invert(b),V=typeof f=="function"?f.apply(this,arguments):f;return o(j($(y,V),b,x),p,d)},a,r)},_.translateBy=function(e,f,a,r){_.transform(e,function(){return o(this.__zoom.translate(typeof f=="function"?f.apply(this,arguments):f,typeof a=="function"?a.apply(this,arguments):a),n.apply(this,arguments),d)},null,r)},_.translateTo=function(e,f,a,r,p){_.transform(e,function(){var y=n.apply(this,arguments),b=this.__zoom,x=r==null?q(y):typeof r=="function"?r.apply(this,arguments):r;return o(Mt.translate(x[0],x[1]).scale(b.k).translate(typeof f=="function"?-f.apply(this,arguments):-f,typeof a=="function"?-a.apply(this,arguments):-a),y,d)},r,p)};function $(e,f){return f=Math.max(i[0],Math.min(i[1],f)),f===e.k?e:new xt(f,e.x,e.y)}function j(e,f,a){var r=f[0]-a[0]*e.k,p=f[1]-a[1]*e.k;return r===e.x&&p===e.y?e:new xt(e.k,r,p)}function q(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function k(e,f,a,r){e.on("start.zoom",function(){v(this,arguments).event(r).start()}).on("interrupt.zoom end.zoom",function(){v(this,arguments).event(r).end()}).tween("zoom",function(){var p=this,y=arguments,b=v(p,y).event(r),x=n.apply(p,y),V=a==null?q(x):typeof a=="function"?a.apply(p,y):a,Y=Math.max(x[1][0]-x[0][0],x[1][1]-x[0][1]),A=p.__zoom,L=typeof f=="function"?f.apply(p,y):f,F=h(A.invert(V).concat(Y/A.k),L.invert(V).concat(Y/L.k));return function(R){if(R===1)R=L;else{var K=F(R),lt=Y/K[2];R=new xt(lt,V[0]-K[0]*lt,V[1]-K[1]*lt)}b.zoom(null,R)}})}function v(e,f,a){return!a&&e.__zooming||new D(e,f)}function D(e,f){this.that=e,this.args=f,this.active=0,this.sourceEvent=null,this.extent=n.apply(e,f),this.taps=0}D.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,f){return this.mouse&&e!=="mouse"&&(this.mouse[1]=f.invert(this.mouse[0])),this.touch0&&e!=="touch"&&(this.touch0[1]=f.invert(this.touch0[0])),this.touch1&&e!=="touch"&&(this.touch1[1]=f.invert(this.touch1[0])),this.that.__zoom=f,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var f=W(this.that).datum();c.call(e,this.that,new ue(e,{sourceEvent:this.sourceEvent,target:_,type:e,transform:this.that.__zoom,dispatch:c}),f)}};function C(e,...f){if(!t.apply(this,arguments))return;var a=v(this,f).event(e),r=this.__zoom,p=Math.max(i[0],Math.min(i[1],r.k*Math.pow(2,s.apply(this,arguments)))),y=ot(e);if(a.wheel)(a.mouse[0][0]!==y[0]||a.mouse[0][1]!==y[1])&&(a.mouse[1]=r.invert(a.mouse[0]=y)),clearTimeout(a.wheel);else{if(r.k===p)return;a.mouse=[y,r.invert(y)],vt(this),a.start()}ht(e),a.wheel=setTimeout(b,G),a.zoom("mouse",o(j($(r,p),a.mouse[0],a.mouse[1]),a.extent,d));function b(){a.wheel=null,a.end()}}function P(e,...f){if(z||!t.apply(this,arguments))return;var a=e.currentTarget,r=v(this,f,!0).event(e),p=W(e.view).on("mousemove.zoom",V,!0).on("mouseup.zoom",Y,!0),y=ot(e,a),b=e.clientX,x=e.clientY;ae(e.view),yt(e),r.mouse=[y,this.__zoom.invert(y)],vt(this),r.start();function V(A){if(ht(A),!r.moved){var L=A.clientX-b,F=A.clientY-x;r.moved=L*L+F*F>B}r.event(A).zoom("mouse",o(j(r.that.__zoom,r.mouse[0]=ot(A,a),r.mouse[1]),r.extent,d))}function Y(A){p.on("mousemove.zoom mouseup.zoom",null),se(A.view,r.moved),ht(A),r.event(A).end()}}function N(e,...f){if(t.apply(this,arguments)){var a=this.__zoom,r=ot(e.changedTouches?e.changedTouches[0]:e,this),p=a.invert(r),y=a.k*(e.shiftKey?.5:2),b=o(j($(a,y),r,p),n.apply(this,f),d);ht(e),m>0?W(this).transition().duration(m).call(k,b,r,e):W(this).call(_.transform,b,r,e)}}function Z(e,...f){if(t.apply(this,arguments)){var a=e.touches,r=a.length,p=v(this,f,e.changedTouches.length===r).event(e),y,b,x,V;for(yt(e),b=0;b<r;++b)x=a[b],V=ot(x,this),V=[V,this.__zoom.invert(V),x.identifier],p.touch0?!p.touch1&&p.touch0[2]!==V[2]&&(p.touch1=V,p.taps=0):(p.touch0=V,y=!0,p.taps=1+!!g);g&&(g=clearTimeout(g)),y&&(p.taps<2&&(w=V[0],g=setTimeout(function(){g=null},I)),vt(this),p.start())}}function Q(e,...f){if(this.__zooming){var a=v(this,f).event(e),r=e.changedTouches,p=r.length,y,b,x,V;for(ht(e),y=0;y<p;++y)b=r[y],x=ot(b,this),a.touch0&&a.touch0[2]===b.identifier?a.touch0[0]=x:a.touch1&&a.touch1[2]===b.identifier&&(a.touch1[0]=x);if(b=a.that.__zoom,a.touch1){var Y=a.touch0[0],A=a.touch0[1],L=a.touch1[0],F=a.touch1[1],R=(R=L[0]-Y[0])*R+(R=L[1]-Y[1])*R,K=(K=F[0]-A[0])*K+(K=F[1]-A[1])*K;b=$(b,Math.sqrt(R/K)),x=[(Y[0]+L[0])/2,(Y[1]+L[1])/2],V=[(A[0]+F[0])/2,(A[1]+F[1])/2]}else if(a.touch0)x=a.touch0[0],V=a.touch0[1];else return;a.zoom("touch",o(j(b,x,V),a.extent,d))}}function H(e,...f){if(this.__zooming){var a=v(this,f).event(e),r=e.changedTouches,p=r.length,y,b;for(yt(e),z&&clearTimeout(z),z=setTimeout(function(){z=null},I),y=0;y<p;++y)b=r[y],a.touch0&&a.touch0[2]===b.identifier?delete a.touch0:a.touch1&&a.touch1[2]===b.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),a.taps===2&&(b=ot(b,this),Math.hypot(w[0]-b[0],w[1]-b[1])<E)){var x=W(this).on("dblclick.zoom");x&&x.apply(this,arguments)}}}return _.wheelDelta=function(e){return arguments.length?(s=typeof e=="function"?e:mt(+e),_):s},_.filter=function(e){return arguments.length?(t=typeof e=="function"?e:mt(!!e),_):t},_.touchable=function(e){return arguments.length?(l=typeof e=="function"?e:mt(!!e),_):l},_.extent=function(e){return arguments.length?(n=typeof e=="function"?e:mt([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),_):n},_.scaleExtent=function(e){return arguments.length?(i[0]=+e[0],i[1]=+e[1],_):[i[0],i[1]]},_.translateExtent=function(e){return arguments.length?(d[0][0]=+e[0][0],d[1][0]=+e[1][0],d[0][1]=+e[0][1],d[1][1]=+e[1][1],_):[[d[0][0],d[0][1]],[d[1][0],d[1][1]]]},_.constrain=function(e){return arguments.length?(o=e,_):o},_.duration=function(e){return arguments.length?(m=+e,_):m},_.interpolate=function(e){return arguments.length?(h=e,_):h},_.on=function(){var e=c.on.apply(c,arguments);return e===c?_:e},_.clickDistance=function(e){return arguments.length?(B=(e=+e)*e,_):Math.sqrt(B)},_.tapDistance=function(e){return arguments.length?(E=+e,_):E},_}const _e={__name:"Select",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(t){const n=Ht(t,"modelValue");return(o,s)=>Kt((at(),rt("select",{"onUpdate:modelValue":s[1]||(s[1]=l=>n.value=l),class:"mt-3 rounded-sm bg-primary text-background w-full font-bold outline-none select-none"},[jt(o.$slots,"default",{onChange:s[0]||(s[0]=l=>o.$emit("update:modelValue"))})],512)),[[Ut,n.value]])}};function tt(t,n){const o=t.x-n.x,s=t.z-n.z,l=Math.abs(o),i=Math.abs(s);let d,m;const h=s>=0?-1:1,c=o>=0?-1:1;return l>=i?(d=t.x+c*i,m=t.z+h*i):(d=t.x+c*l,m=t.z+h*l),{x:d,z:m}}const O=(t,n)=>Math.max(Math.abs(t.x-n.x),Math.abs(t.z-n.z));function xe(t){let n=0,o=0;return t.bolts.forEach(s=>{o+=s.length,s.directed===!1&&(n+=s.length)}),n+=o,[n,o]}function ve(t){const n=t.stations,o=t.bolts,s=n.length,l=Number.POSITIVE_INFINITY,i=Array.from({length:s},()=>Array(s).fill(l));for(let h=0;h<s;h++)i[h][h]=0;for(const h of o){const c=n.find(w=>w.name===h.station_a.name),g=n.find(w=>w.name===h.station_b.name);if(c&&g){const w=n.indexOf(c),z=n.indexOf(g);i[w][z]=h.length,i[z][w]=h.length}}for(let h=0;h<s;h++)for(let c=0;c<s;c++)for(let g=0;g<s;g++)i[c][h]!==l&&i[h][g]!==l&&(i[c][g]=Math.min(i[c][g],i[c][h]+i[h][g]));let d=0,m=0;for(let h=0;h<s;h++)for(let c=0;c<s;c++)h!==c&&i[h][c]!==l&&(d+=i[h][c],m++);return ye(i,n),d/m/20}function ye(t,n){const o=[];for(let l=0;l<n.length;l++){const d={station_name:n[l].name,values:[]};for(let m=0;m<n.length;m++)d.values.push(t[l][m]);o.push(d)}const s=JSON.stringify(o);localStorage.setItem("distance-matrix",s)}function Bt(t,n,o,s,l){t.bolts=[];const i=t.stations,d=i.length;let m=0,h=0;if(o==="track"&&s!==void 0&&l!==void 0)m=s,h=l;else if(o==="median"){const g=i.map(z=>z.x),w=i.map(z=>z.z);m=Math.round(Ct(g)),h=Math.round(Ct(w))}else if(o==="average"){const g=i.reduce((z,I)=>z+I.x,0),w=i.reduce((z,I)=>z+I.z,0);m=Math.round(g/d),h=Math.round(w/d)}else o==="spawn"&&(m=-80,h=-176);const c={name:"Mergeing point",description:"",colour:"",x:m,z:h};for(let g=0;g<d;++g){const w=i[g];let z;const I=Math.abs(w.x-c.x)/Math.abs(w.z-c.z);n==8&&I>.57735&&I<1.7321?z=tt(c,w):z=tt(w,c),t.bolts.push({directed:!1,station_a:w,turn:z,station_b:c,length:O(w,c),colour:"#8f7f10"})}return t}function Ct(t){if(t.length===0)throw new Error("Input array is empty");t=[...t].sort((o,s)=>o-s);const n=Math.floor(t.length/2);return t.length%2?t[n]:(t[n-1]+t[n])/2}function Et(t){t.bolts=[];const n=t.stations,o=n.length;for(let s=0;s<o;++s)for(let l=s+1;l<o;++l){const i=n[s],d=n[l];t.bolts.push({directed:!1,station_a:i,turn:tt(i,d),station_b:d,length:O(i,d),colour:"#8f7f10"})}return t}function be(t){t.bolts=[];const n=t.stations,o=n.length;let s={stations:[],bolts:[]},l=1/0;for(let i=0;i<o;++i){let d=function(z){let I=1/0,G=null;for(let B=0;B<o;++B)if(!m[B]){const E=n[B],_=O(z,E);_<I&&(I=_,G=E)}return G};const m=new Array(o).fill(!1);let h=n[i];m[i]=!0;const c=[];let g;for(;(g=d(h))!==null;)c.push({directed:!1,station_a:h,turn:tt(h,g),station_b:g,length:O(h,g),colour:"#8f7f10"}),m[n.indexOf(g)]=!0,h=g;c.push({directed:!1,station_a:h,turn:tt(h,n[i]),station_b:n[i],length:O(h,n[i]),colour:"#8f7f10"});const w=c.reduce((z,I)=>z+I.length,0);w<l&&(s={stations:n.slice(),bolts:c.slice()},l=w)}return s}function ze(t){t.bolts=[];const n=t.stations,o=n.length;let s={stations:[],bolts:[]},l=1/0;for(let i=0;i<o;++i){let d=function(z){let I=1/0,G=null;for(let B=0;B<o;++B)if(!m[B]){const E=n[B],_=O(z,E);_<I&&(I=_,G=E)}return G};const m=new Array(o).fill(!1);let h=n[i];m[i]=!0;const c=[];let g;for(;(g=d(h))!==null;)c.push({directed:!1,station_a:h,turn:tt(h,g),station_b:g,length:O(h,g),colour:"#8f7f10"}),m[n.indexOf(g)]=!0,h=g;const w=c.reduce((z,I)=>z+I.length,0);w<l&&(s={stations:n.slice(),bolts:c.slice()},l=w)}return s}et("scatter-plot",{});function Me(t){const n=t.stations,o=n.length,s=new Array(o).fill(!1),l=new Array(o).fill(-1),i=new Array(o).fill(1/0);i[0]=0;for(let m=0;m<o-1;++m){const h=we(i,s);s[h]=!0;for(let c=0;c<o;++c){const g=O(n[h],n[c]);g!==0&&!s[c]&&g<i[c]&&(l[c]=h,i[c]=g)}}const d=[];for(let m=1;m<o;++m)d.push({directed:!1,station_a:{name:n[l[m]].name,x:n[l[m]].x,z:n[l[m]].z},turn:tt(n[l[m]],n[m]),station_b:{name:n[m].name,x:n[m].x,z:n[m].z},length:O(n[l[m]],n[m]),colour:"#8f7f10"});return{stations:n.slice(),bolts:d}}function we(t,n){let o=1/0,s=-1;for(let l=0;l<t.length;l++)!n[l]&&t[l]<o&&(o=t[l],s=l);return s}class ke{constructor(n){St(this,"parent");this.parent=Array(n).fill(-1)}find(n){let o=n;for(;this.parent[o]!==-1;)o=this.parent[o];let s=n;for(;s!==o;){const l=this.parent[s];if(l===s)break;this.parent[s]=o,s=l}return o}union(n,o){const s=this.find(n),l=this.find(o);s!==l&&(this.parent[s]=l)}}function Se(t){const n=t.stations,o=t.bolts;o.sort((i,d)=>i.length-d.length);const s=new ke(n.length),l=[];return o.forEach(i=>{const d=n.findIndex(g=>g.name===i.station_a.name),m=n.findIndex(g=>g.name===i.station_b.name),h=s.find(d),c=s.find(m);h!==c&&(l.push(i),s.union(h,c))}),t.bolts=l,t}const Te={class:"fixed top-0 right-0 w-48 backdrop-blur p-5"},Ie=M("p",{class:"text-center text-accent"},[M("a",{href:"https://github.com/KK-mp4/Bolt-Routing-Problem-V2",target:"_blank",rel:"noopener noreferrer",title:"GitHub"}," Piston Bolt Network Builder "),M("span",{class:"text-[10px] text-text"},"*early alpha build by kk")],-1),Pe=M("option",{value:"None"},"None",-1),Ve=M("option",{value:"Star graph"},"Star graph (WIP)",-1),Be=M("option",{value:"Complete graph"},"Complete graph",-1),Ce=M("option",{value:"Nearest neighbor"},"Nearest neighbor (WIP)",-1),Ee=M("option",{value:"Hamiltonian cycle"},"Hamiltonian cycle (WIP)",-1),De=M("option",{value:"Prim's algorithm"},"Prim's algorithm (WIP)",-1),Ae=M("option",{value:"Kruskal's algorithm"},"Kruskal's algorithm (WIP)",-1),Ne={key:0},Ge=M("option",{value:"4"},[J("S"),M("sub",null,"4")],-1),Xe=M("option",{value:"8"},[J("S"),M("sub",null,"8")],-1),Ye=M("option",{value:"median"},"Median",-1),Le=M("option",{value:"average"},"Average",-1),Re=M("option",{value:""},"0, 0",-1),$e=M("option",{value:"spawn"},"Spawn",-1),He=M("option",{value:"track"},"Track mouse",-1),Ke={class:"fixed top-0 left-0 backdrop-blur p-5 pb-1"},Ue={class:"text-xs"},je=M("br",null,null,-1),Fe={key:0,class:"text-accent"},We={key:1,class:"text-accent"},Oe={class:"text-xs mt-1"},qe=M("br",null,null,-1),Ze={class:"text-accent"},Qe={class:"text-xs mt-1"},Je=M("br",null,null,-1),tn={class:"text-accent"},en={key:0,class:"text-xs mt-1 mb-2"},nn=M("br",null,null,-1),on={class:"text-accent"},an=M("br",null,null,-1),sn=M("br",null,null,-1),rn={class:"fixed bottom-0 left-0 text-sm select-none"},ln=M("div",{class:"fixed bottom-0 right-0 text-[10px] select-none"},[M("p",null,"pan: drag mouse1 / zoom: scroll mouse3 / connect: drag mouse3")],-1),cn=M("div",{id:"network_map",class:"p-0 h-full w-full"},null,-1),gn=Ft({__name:"index",setup(t){Jt({title:"Bolt Routing Problem V2"});const n=dt(""),o=et("piston-bolt-network",{});let s={},l=[],i=!1;const d=dt(0),m=dt(0),h=dt(0),c=et("graph-type",""),g=et("star-graph-s",8),w=et("star-graph-merge-pos","median");let z=Mt;const I=et("show-labels",!1),G=et("colour-graph",!1),B=et("calculate-stats",!0);Wt(async()=>{if(window.addEventListener("resize",E),!o.value.stations){const v=await(await fetch("/data/network.json")).json();o.value=v}_()});function E(){let k=document.getElementById("network_map");k!==null&&(k.innerHTML="");const v={top:-1,right:0,bottom:50,left:75},D=window.innerWidth,C=window.innerHeight,P=D-v.right-v.left,N=C-v.top-v.bottom,Z=Tt(o.value.stations,u=>Math.abs(u.x)),Q=Tt(o.value.stations,u=>Math.abs(u.z)),H=Math.max(Z,Q)*1.01,e=P/N;let f,a;e>1?(f=H*e,a=H):(f=H,a=H/e);const r=It().domain([-a,a]).range([v.top,N]),p=It().domain([-f,f]).range([v.right,P]),y=ee(r),b=ne(p),x=W("#network_map").append("svg").attr("width",D).attr("height",C);x.append("g").attr("id","y_axis").attr("transform","translate(75, 0)").call(y).style("font-family","Fira Code").style("font-size","10px"),x.append("g").attr("id","x_axis").attr("transform",`translate(${v.left}, ${C-v.bottom-v.top})`).call(b).style("font-family","Fira Code").style("font-size","10px");const V=Math.round(Math.min(P,N)/64),Y=Math.round(Math.min(P,N)/64*(N/P));x.select("#x_axis").call(b.scale(p).ticks(V).tickSize(-N)),x.select("#y_axis").call(y.scale(r).ticks(Y).tickSize(-P)),x.selectAll(".tick line").style("stroke","#422B25");const A=x.append("g").attr("id","edges_a").attr("transform","translate(75, 0)").selectAll("line").data(o.value.bolts).enter().append("line").attr("x1",u=>p(u.station_a.x)).attr("y1",u=>r(u.station_a.z)).attr("x2",u=>p(u.turn.x)).attr("y2",u=>r(u.turn.z)).style("stroke",u=>u.colour).style("stroke-width",1),L=x.append("g").attr("id","edges_b").attr("transform","translate(75, 0)").selectAll("line").data(o.value.bolts).enter().append("line").attr("x1",u=>p(u.turn.x)).attr("y1",u=>r(u.turn.z)).attr("x2",u=>p(u.station_b.x)).attr("y2",u=>r(u.station_b.z)).style("stroke",u=>u.colour).style("stroke-width",1),F=x.append("g").attr("id","vertices").attr("transform","translate(75, 0)").selectAll("circle").data(o.value.stations).enter().append("circle").attr("r",4).attr("cx",u=>p(u.x)).attr("cy",u=>r(u.z)).style("fill",u=>u.colour).on("click",(u,S)=>Dt(S)).on("mousedown",(u,S)=>{u.button===1&&At(u,S)}).on("mouseup",(u,S)=>{u.button===1&&Nt(u,S)}),R=x.append("g").attr("id","lables").style("font-family","Fira Code").style("fill","#fbdfd8").style("font-size","10px").selectAll("text").data(o.value.stations).join("text").attr("dy","0.35em").attr("x",u=>p(u.x)).attr("y",u=>r(u.z)-14).text(u=>u.name).style("visibility",I.value?"visible":"hidden"),K=ge().on("zoom",lt);x.call(K),z!==void 0&&x.call(K.transform,z),x.on("mousemove",u=>{if(c.value==="Star graph"&&w.value==="track"){const S=x.node(),X=S.createSVGPoint();X.x=u.offsetX,X.y=u.offsetY;const T=S.getScreenCTM(),st=X.matrixTransform(T.inverse()),pt=st.x-v.left,ft=st.y-v.top;o.value=Bt(o.value,g.value,w.value,Math.round(p.invert(pt)),Math.round(r.invert(ft))),E(),$()}i&&s.name!==void 0&&(l=[u.offsetX,u.offsetY],Gt(x,s,l))}),x.on("mousedown",u=>{u.button===1&&(i=!0)}),x.on("mouseup",u=>{u.button===1&&(i=!1,x.select("#temp-line").remove())});function lt({transform:u}){z=u,W("#y_axis").transition().duration(50).call(y.scale(u.rescaleY(r))),W("#x_axis").transition().duration(50).call(b.scale(u.rescaleX(p)));const S=u.rescaleX(p),X=u.rescaleY(r);x.select("#x_axis").call(b.scale(S).ticks(V).tickSize(-N)),x.select("#y_axis").call(y.scale(X).ticks(Y).tickSize(-P)),x.selectAll(".tick line").style("stroke","#422B25"),F.data(o.value.stations).attr("cx",T=>S(T.x)).attr("cy",T=>X(T.z)),R.data(o.value.stations).attr("x",T=>S(T.x)).attr("y",T=>X(T.z)-14),A.data(o.value.bolts).attr("x1",T=>S(T.station_a.x)).attr("y1",T=>X(T.station_a.z)).attr("x2",T=>S(T.turn.x)).attr("y2",T=>X(T.turn.z)),L.data(o.value.bolts).attr("x1",T=>S(T.turn.x)).attr("y1",T=>X(T.turn.z)).attr("x2",T=>S(T.station_b.x)).attr("y2",T=>X(T.station_b.z)),s.name}function Dt(u){n.value=u.name+" { X: "+u.x+" , Z: "+u.z+" }"}function At(u,S){s={name:S.name,description:"",colour:"",x:S.x,z:S.z},n.value="Draw bolt from "+s.name}function Nt(u,S){!s.name||S.name===s.name||(o.value.bolts.push({directed:!1,station_a:s,turn:tt(s,S),station_b:S,length:O(s,S),colour:"#8f7f10"}),E(),$(),n.value+=" to "+S.name)}function Gt(u,S,X){u.select("#temp-line").remove();const T=u.node(),st=T.createSVGPoint();st.x=X[0]+1,st.y=X[1];const pt=T.getScreenCTM(),ft=st.matrixTransform(pt.inverse()),Xt=ft.x-v.left,Yt=ft.y-v.top,wt={name:"",colour:"",description:"",x:p.invert(Xt),z:r.invert(Yt)},kt=tt(S,wt),Lt=[{start:S,end:kt},{start:kt,end:wt}];u.append("g").attr("id","temp-line").attr("transform",`translate(${v.left}, ${v.top})`).selectAll("line").data(Lt).enter().append("line").attr("x1",nt=>p(nt.start.x)).attr("y1",nt=>r(nt.start.z)).attr("x2",nt=>p(nt.end.x)).attr("y2",nt=>r(nt.end.z)).style("stroke","gray").style("stroke-width",2).style("stroke-dasharray","5 5")}}function _(){const k=Date.now();switch(c.value){case"None":{o.value.bolts=[];break}case"Star graph":{o.value=Bt(o.value,g.value,w.value);break}case"Complete graph":{o.value=Et(o.value);break}case"Nearest neighbor":{o.value=ze(o.value);break}case"Hamiltonian cycle":{o.value=be(o.value);break}case"Prim's algorithm":{o.value=Me(o.value);break}case"Kruskal's algorithm":{o.value=Se(Et(o.value));break}}n.value="Processing time: "+(Date.now()-k)+"ms",G.value&&j(),E(),$()}function $(){[d.value,m.value]=xe(o.value),B.value&&(h.value=ve(o.value))}function j(){o.value.stations.forEach(k=>{k.colour=q()}),o.value.bolts.forEach(k=>{const v=o.value.stations.find(D=>D.name===k.station_b.name);v?k.colour=v.colour:console.error(`Station ${k.station_b.name} not found in network.`)})}function q(){const k=Math.floor(Math.random()*361),v=80,D=74,C=(1-Math.abs(2*(D/100)-1))*(v/100),P=C*(1-Math.abs(k/60%2-1)),N=D/100-C/2;let Z=0,Q=0,H=0;k>=0&&k<60?(Z=C,Q=P):k>=60&&k<120?(Z=P,Q=C):k>=120&&k<180?(Q=C,H=P):k>=180&&k<240?(Q=P,H=C):k>=240&&k<300?(Z=P,H=C):k>=300&&k<360&&(Z=C,H=P);const e=a=>{const r=Math.round(a*255).toString(16);return r.length===1?"0"+r:r};return`#${e(Z+N)}${e(Q+N)}${e(H+N)}`.toUpperCase()}return Ot(()=>{window.removeEventListener("resize",E)}),(k,v)=>{const D=_e,C=Qt;return at(),rt(Zt,null,[M("div",Te,[Ie,ct(D,{modelValue:U(c),"onUpdate:modelValue":v[0]||(v[0]=P=>gt(c)?c.value=P:null),onChange:_},{default:it(()=>[Pe,Ve,Be,Ce,Ee,De,Ae]),_:1},8,["modelValue"]),U(c)==="Star graph"?(at(),rt("div",Ne,[ct(D,{modelValue:U(g),"onUpdate:modelValue":v[1]||(v[1]=P=>gt(g)?g.value=P:null),onChange:_},{default:it(()=>[Ge,Xe]),_:1},8,["modelValue"]),ct(D,{modelValue:U(w),"onUpdate:modelValue":v[2]||(v[2]=P=>gt(w)?w.value=P:null),onChange:_},{default:it(()=>[Ye,Le,Re,$e,He]),_:1},8,["modelValue"])])):_t("",!0)]),M("div",Ke,[M("p",Ue,[J("Stations:"),je,U(o).stations?(at(),rt("span",Fe,ut(U(o).stations.length),1)):(at(),rt("span",We,"0"))]),M("p",Oe,[J("Bolt length:"),qe,M("span",Ze,ut(U(d))+" blocks",1)]),M("p",Qe,[J("Tunnel length:"),Je,M("span",tn,ut(U(m))+" blocks",1)]),U(B)?(at(),rt("p",en,[J("Average travel time:"),nn,M("span",on,ut(Math.round(U(h)*100)/100)+" s",1)])):_t("",!0),ct(C,{to:"/settings",title:"Setting page",class:"text-xs"},{default:it(()=>[J("Settings ->"),an]),_:1}),U(B)?(at(),qt(C,{key:1,to:"/heatmap",title:"Distance matrix heatmap",class:"text-xs"},{default:it(()=>[J("Heatmap ->"),sn]),_:1})):_t("",!0),ct(C,{to:"/scatterplot",title:"Scatter plot",class:"text-xs"},{default:it(()=>[J("Scatter plot ->")]),_:1})]),M("p",rn,ut(U(n)),1),ln,cn],64)}}});export{gn as default};
