import{_ as B}from"./CTGTP2KQ.js";import{u as C}from"./ErMchg64.js";import{i as M,s as F,a as O,b as S,l as N,m as w}from"./B7PevS6S.js";import{u as D}from"./B-WDjgS2.js";import{f as E,r as H,g as L,c as R,b as V,w as j,a as I,t as z,u as G,F as P,o as T,d as W}from"./U3-ZX0SS.js";class _ extends Map{constructor(n,r=K){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),n!=null)for(const[e,a]of n)this.set(e,a)}get(n){return super.get(b(this,n))}has(n){return super.has(b(this,n))}set(n,r){return super.set(q(this,n),r)}delete(n){return super.delete(J(this,n))}}function b({_intern:t,_key:n},r){const e=n(r);return t.has(e)?t.get(e):r}function q({_intern:t,_key:n},r){const e=n(r);return t.has(e)?t.get(e):(t.set(e,r),r)}function J({_intern:t,_key:n},r){const e=n(r);return t.has(e)&&(r=t.get(e),t.delete(e)),r}function K(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Q(t,n,r){t=+t,n=+n,r=(a=arguments.length)<2?(n=t,t=0,1):a<3?1:+r;for(var e=-1,a=Math.max(0,Math.ceil((n-t)/r))|0,o=new Array(a);++e<a;)o[e]=t+e*r;return o}const k=Symbol("implicit");function $(){var t=new _,n=[],r=[],e=k;function a(o){let u=t.get(o);if(u===void 0){if(e!==k)return e;t.set(o,u=n.push(o)-1)}return r[u%r.length]}return a.domain=function(o){if(!arguments.length)return n.slice();n=[],t=new _;for(const u of o)t.has(u)||t.set(u,n.push(u)-1);return a},a.range=function(o){return arguments.length?(r=Array.from(o),a):r.slice()},a.unknown=function(o){return arguments.length?(e=o,a):e},a.copy=function(){return $(n,r).unknown(e)},M.apply(a,arguments),a}function y(){var t=$().unknown(void 0),n=t.domain,r=t.range,e=0,a=1,o,u,m=!1,f=0,c=0,g=.5;delete t.unknown;function d(){var i=n().length,h=a<e,p=h?a:e,v=h?e:a;o=(v-p)/Math.max(1,i-f+c*2),m&&(o=Math.floor(o)),p+=(v-p-o*(i-f))*g,u=o*(1-f),m&&(p=Math.round(p),u=Math.round(u));var s=Q(i).map(function(l){return p+o*l});return r(h?s.reverse():s)}return t.domain=function(i){return arguments.length?(n(i),d()):n()},t.range=function(i){return arguments.length?([e,a]=i,e=+e,a=+a,d()):[e,a]},t.rangeRound=function(i){return[e,a]=i,e=+e,a=+a,m=!0,d()},t.bandwidth=function(){return u},t.step=function(){return o},t.round=function(i){return arguments.length?(m=!!i,d()):m},t.padding=function(i){return arguments.length?(f=Math.min(1,c=+i),d()):f},t.paddingInner=function(i){return arguments.length?(f=Math.min(1,i),d()):f},t.paddingOuter=function(i){return arguments.length?(c=+i,d()):c},t.align=function(i){return arguments.length?(g=Math.max(0,Math.min(1,i)),d()):g},t.copy=function(){return y(n(),[e,a]).round(m).paddingInner(f).paddingOuter(c).align(g)},M.apply(d(),arguments)}const U={class:"fixed bottom-0 left-0 text-sm select-none"},X=I("div",{id:"distance-matrix",class:"p-0 h-full w-full"},null,-1),at=E({__name:"heatmap",setup(t){C({title:"Distance matrix heatmap"});const n=D("distance-matrix",{}),r=H("");L(()=>{e(n.value)});function e(a){const o={top:30,right:30,bottom:150,left:200},u=window.innerWidth-o.left-o.right,m=window.innerHeight-o.top-o.bottom,f=F("#distance-matrix").append("svg").attr("width",u+o.left+o.right).attr("height",m+o.top+o.bottom).append("g").attr("transform",`translate(${o.left}, ${o.top})`),c=a.map(s=>s.station_name),g=y().range([0,u]).domain(c).padding(.01);f.append("g").attr("transform",`translate(0, ${m})`).call(O(g)).selectAll("text").attr("transform","rotate(-45)").attr("x",-5).attr("y",5).style("font-family","Fira Code").style("font-size","10px").style("fill","#fbdfd8").style("text-anchor","end");const d=y().range([m,0]).domain(c).padding(.01);f.append("g").call(S(d)).selectAll("text").attr("x",-8).attr("y",-8).style("font-family","Fira Code").style("fill","#fbdfd8").attr("dy","10px");const i=N().range(["#F4EDE1","#84BBA7"]).domain([0,w(a,s=>w(s.values))]),h=function(s,l){const x=l.value!==null?l.value+" blocks":"does not exist";r.value=`Shortest path from ${c[l.rowIndex]} to ${c[l.colIndex]} - ${x}`},p=function(s,l){const x=l.value!==null?l.value+" blocks":"does not exist";r.value=`Shortest path from ${c[l.rowIndex]} to ${c[l.colIndex]} - ${x}`},v=function(s){r.value=""};f.selectAll().data(a).enter().append("g").selectAll("rect").data((s,l)=>s.values.map((x,A)=>({value:x,rowIndex:l,colIndex:A}))).enter().append("rect").attr("x",s=>g(c[s.colIndex])).attr("y",s=>d(c[s.rowIndex])).attr("width",g.bandwidth()).attr("height",d.bandwidth()).style("fill",s=>i(s.value)).on("mouseover",(s,l)=>h(s,l)).on("mousemove",(s,l)=>p(s,l)).on("mouseleave",s=>v())}return(a,o)=>{const u=B;return T(),R(P,null,[V(u,{to:"/",title:"Go back to main page",class:"fixed top-3 left-3 text-xs"},{default:j(()=>[W("‚Üê Back")]),_:1}),I("p",U,z(G(r)),1),X],64)}}});export{at as default};
